--CREATING VIEWS---------------------------------------------------------------
--Customer_v - for each customer, indicate his or her name as well as 
--the customer type (prospect, steady or premier) as well as the number of years that customer has been with us.
DROP VIEW Customer_v;
CREATE VIEW Customer_v AS SELECT custName, custPhone FROM Customer;
SELECT * FROM Customer_v;

--Customer_addresses_v – for each customer, indicate whether they are an individual or a corporate account,
--and display all of the addresses that we are managing for that customer.
DROP VIEW Customer_addresses_v;
CREATE VIEW Customer_addresses_v AS SELECT
SELECT * FROM Customer_addresses_v;

--Mechanic_mentor_v – reports all of the mentor/mentee relationships at Dave’s, sorted by the name of the mentor, 
--then the name of the mentee.
DROP VIEW Mechanic_mentor_v;
CREATE VIEW Mechanic_mentor_v AS SELECT 'Mentee' AS "Mentee", menteeEmpID, 'Mentor' AS "Mentor", mentorEmpID AS mentor, skillLearned
    FROM Mechanic mr INNER JOIN Mechanic me
    ON mr.empID = me.empId
    NATURAL JOIN Mentorship m
    LIMIT 9;
SELECT * FROM Mechanic_mentor_v;

--Premier_profits_v – On a year by year basis, show the premier customer’s outlay versus what they would have been 
--charged for the services which they received had they merely been steady customers.
DROP VIEW Premier_profits_v;
CREATE VIEW Premier_profits_v AS SELECT
SELECT * FROM Premier_profits_v;

DROP VIEW Prospective_resurrection_v;
CREATE VIEW Prospective_resurrection_v AS 
SELECT custname, year(now()) - year(refferalDate) as TimeSinceRefferal, COUNT(dateContact) AS NumOfContacts
FROM Prospective 
NATURAL JOIN Customer 
NATURAL JOIN Contact
WHERE refferalDate < '2014-12-12' 
GROUP BY custID;
SELECT * FROM Prospective_resurrection_v;
