--1 NEEDS WORK
SELECT 'Premier', custName, custPhone, custEmail FROM Premier
NATURAL JOIN Customer
UNION
SELECT 'Steady',custName, custPhone, custEmail FROM Steady
NATURAL JOIN Customer
UNION
SELECT 'Prospective',custName, custPhone, custEmail FROM Prospective
NATURAL JOIN Customer;
----------------------------------------------------------------------------------

--2
SELECT serviceDate, custName, cost 
FROM ServiceVisit 
NATURAL JOIN Vehicle 
NATURAL JOIN Customer;
----------------------------------------------------------------------------------

--3

----------------------------------------------------------------------------------

--4
SELECT empName, COUNT(skillName) AS NumberOfSkills 
FROM MechanicSkill  me 
INNER JOIN Employee e 
ON me.empID = e.empID
GROUP BY e.empID HAVING COUNT(skillName) >= 3;
----------------------------------------------------------------------------------

--5
--a

--b

----------------------------------------------------------------------------------

--6
SELECT packageName, packageCost, itemName 
FROM Package 
NATURAL JOIN Item;
----------------------------------------------------------------------------------

--7
SELECT empName, (SELECT (SELECT COUNT(skillName) from MechanicSkill
GROUP BY empID ORDER BY COUNT(skillName) DESC LIMIT 1) - COUNT(MechanicSkill.empID))
AS "Skills Missing" FROM Employee
INNER JOIN MechanicSkill ON Employee.empID = MechanicSkill.empID
GROUP BY MechanicSkill.empID HAVING COUNT(MechanicSkill.empID) < 4;
----------------------------------------------------------------------------------

--8 DOESN'T NEET TO BE DONE :D

----------------------------------------------------------------------------------

--9

select custName, (ph.paid-p.fee) as 'difference' from Customer c inner join Premier p on c.custID=p.custID
inner join PaymentHistory ph on p.custID=ph.custID where ph.payDate < '2017-12-31' ORDER BY difference DESC;
----------------------------------------------------------------------------------

--10

----------------------------------------------------------------------------------

--11

----------------------------------------------------------------------------------

--12

----------------------------------------------------------------------------------

--13

----------------------------------------------------------------------------------

--14

----------------------------------------------------------------------------------

--15
SELECT empName AS 'Mechanic and Advisor' 
FROM Employee 
NATURAL JOIN Mechanic 
NATURAL JOIN ServiceAdvisor 
WHERE Mechanic.empID=ServiceAdvisor.empID;
----------------------------------------------------------------------------------

--16

----------------------------------------------------------------------------------

--17
SELECT itemName 
FROM Item
WHERE packageName IS NULL;
----------------------------------------------------------------------------------

--18
--a.
--Output mechanics that must mentor but have not 
SELECT empName, mustMentor, hasMentored
FROM Mechanic
NATURAL JOIN Employee
WHERE mustMentor = 1 AND hasMentored = 0;

--b.

--c.


